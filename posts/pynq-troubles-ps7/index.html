<!DOCTYPE html>
<html><head>
	<title>møøn</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="/assets/css/main.css" />
	
	
	
	
</head>


<body class="is-preload homepage">
	<div id="page-wrapper">

		
		<div id="header-wrapper">
			<header id="header" class="container">

				
				<div id="logo">
					<picture>
						<source srcset="/images/flatmøøn_compressed.png" media="(min-width:40px)">
							<img class="circular--square" src="/images/flatmøøn_compressed.png" >
					</picture>
							
							
				</div>

			</header>
		</div>
		

		
		<div id="features-wrapper">
			<div class="container">
				<div class="row">
				</div>
			</div>
		</div>

	</div>

</body>

	<nav id="nav">
		<ul>
			<li class="current"><a href="/index.html">Welcome</a></li>
			<li>
				<a href="#">Case Study</a>
				<ul>
					<li><a href="#">TBD</a></li>
					<li><a href="#">TBD</a></li>
					<li>
						<a href="#">TBD</a>
						<ul>
							<li><a href="#">TBD</a></li>
							<li><a href="#">TBD</a></li>
							<li><a href="#">TBD</a></li>
							<li><a href="#">TBD</a></li>
						</ul>
					</li>
					<li><a href="#">TBD</a></li>
				</ul>
			</li>
			<li><a href="/store">Store</a></li>
			<li><a href="/about">About</a></li>
			<li><a href="/posts">Archive</a></li>
			
<script type="text/javascript">
	var AllLi = document.getElementsByTagName( "li" );
	var results = [];
	var page  = 'Pynq Troubles: PS7, Hello World, and the pain to get there';
	for ( var x = 0; x < AllLi.length; x++ )
	{
		AllLi[x].className="";
		if ( AllLi[x].innerText == page ) 
			AllLi[x].className="current";
	}
</script>

		</ul>
	</nav>
		
<div id="banner-wrapper">
</div>

    <body><div id="content">



<div id="main-wrapper">
	<div class="container">
		<div id="content">

			
			<article>
				<h2>Pynq Troubles: PS7, Hello World, and the pain to get there</h2>
				<p>Recently I&rsquo;ve started to do some work on my PYNQ-Z1 FPGA. It&rsquo;s a small toy intended for enthusiasts, as well as researchers interested in FPGAs. It uses the unique Zynq chipset, adding 2 ARM cores along with a PL. To use it as an FPGA, there are really a few simple steps. First, grab the [PYNQ][ https://github.com/Xilinx/PYNQ ] git repo and find the board files. Then import them into vivado by manually copying them into the boards directory. Create your project, and you should be good to go&hellip;If you&rsquo;re only planning to use the PL by itself. I came across an issue where the PS FCLKs were not working. The solution was simple: initialize the subsystem by running a simple hello_world application on the xilinx sdk. This will initialize the arm cores and the PS7 system, allowing the PL to access DDR SDRAM using the AXI4 interface. However; I got this message when uploading the elf to the PYNQ board: Memory write error at 0x100000. APB AP transaction error, DAP status f0000021.</p>
<p>Clearly there was something I was missing. 0x100000 references DDR memory, and failed access errors indicate that the initialization process failed. On the xilinx sdk, there are run configurations that are useful to know. You can:</p>
<ol>
<li>Reset the system, clearing the FPGA fabric</li>
<li>Program the FPGA before running the elf file</li>
<li>Run ps7_init, initializing the Processing Subsystem (PS)</li>
<li>run ps7_post_config, enabling level shifters from PL to PS.</li>
</ol>
<p>I tried taking out PS7_init to see if I could upload the elf file. The upload failed, but it gave an important error messags: the DDR memory was held in reset. So ps7_init is an essential file that tells the system to initialize. But what does it contain? mostly mask_write commands. But one thing to note is that this file exists in the zynq hw platform directory. Because the PYNQ platform does not natively exist, you have to create your own ps7_init file and send it to the xilinx sdk, because the configurations are incompatable with each other.</p>
<p>So how do I do that?</p>
<p>To use the clocks generated by the PS, Vivado includes a PS7 Wizard that allows you to customize the system to your liking, as well as calibrate its constraints. Additionally, you can apply a tcl script that calibrates the system to work with your board. Digilent, the PYNQ manufacturer, provides this script on their website. After applying the configuration, a PS7_init.tcl will show up in &lt;PROJECT_NAME&gt;ip_userfiles/mem_init_files. This init script is the one required on the Xilinx sdk. After correctly setting up the path, the hello world application should compile and run, enabling PS/PL communication on the FPGA side. happy hacking!</p>

			</article>

		</div>
	</div>
</div>

        </div><body>
	
	<div id="footer-wrapper">
		<footer id="footer" class="container">
			<div class="row">
				<div class="col-3 col-6-medium col-12-small">

					
					<section class="widget links">
						<h3>Research Reading</h3>
						<ul class="style2">
							<li><a href="https://ieeexplore.ieee.org/document/6718086">
									210 GHz Transceiver</a></li>
							<li><a href="http://hunteng.co.uk/pdfs/tech/ddctheory.pdf">
									Theory of Digital Down Conversion</a></li>
							<li><a href="https://www.eetimes.com/document.asp?doc_id=1272436">
									Power Condition Circuit</a></li>
							<li><a href="https://www.allaboutcircuits.com/technical-articles/dsp-basics-of-digital-down-conversion-digital-signal-processing/">
									 Basics of DDC in DSP</a></li>
							<li><a href="#">TBD</a></li>
						</ul>
					</section>

				</div>
				<div class="col-3 col-6-medium col-12-small">

					
					<section class="widget links">
						<h3>Self-improvement</h3>
						<ul class="style2">
							<li><a href="#">TBD</a></li>
							<li><a href="#">TBD</a></li>
							<li><a href="#">TBD</a></li>
							<li><a href="#">TBD</a></li>
							<li><a href="#">TBD</a></li>
						</ul>
					</section>

				</div>
				<div class="col-3 col-6-medium col-12-small">

					
					<section class="widget links">
						<h3>Books to Read</h3>
						<ul class="style2">
							<li><a href="https://www.amazon.com/gp/product/0671212095/ref=as_li_qf_asin_il_tl?ie=UTF8&tag=farnamstreet-20&creative=9325&linkCode=as2&creativeASIN=0671212095&linkId=95f640336f1079ee3b5acafcc3a34a84">
									How to Read a Book by Adler</a></li>
							<li><a href="https://www.amazon.com/Elements-Style-Fourth-William-Strunk/dp/020530902X">
									The Elements of Style</a></li>
							<li><a href="#">TBD</a></li>
							<li><a href="#">TBD</a></li>
							<li><a href="#">TBD</a></li>
						</ul>
					</section>

				</div>
				<div class="col-3 col-6-medium col-12-small">

					
					<section class="widget contact last">
						<h3>Contact Us</h3>
						<ul>
							<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
							<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
							<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
							<li><a href="#" class="icon brands fa-dribbble"><span class="label">Dribbble</span></a></li>
							<li><a href="#" class="icon brands fa-pinterest"><span class="label">Pinterest</span></a></li>
						</ul>
						<p>justidl3@uci.edu<br />
							Los Angeles, CA<br />
							TBD<br />
							
							
					</section>

				</div>
			</div>
			<div class="row">
				<div class="col-12">
					<div id="copyright">
						<ul class="menu">
							<li>&copy; møøn. All rights reserved</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</div>
				</div>
			</div>
		</footer>
	</div>

	</div>

	

	<script src="/assets/js/jquery.min.js"></script>
	<script src="/assets/js/jquery.dropotron.min.js"></script>
	<script src="/assets/js/browser.min.js"></script>
	<script src="/assets/js/breakpoints.min.js"></script>
	<script src="/assets/js/util.js"></script>
	<script src="/assets/js/main.js"></script>

</body>
</body>
</html>
